# @Project:       Tier 2 Support Task Automation Portal
# @Version:       0.1
# @Author:        Oleg Snegirev <ol.snegirev@gmail.com>
# @Functionality: A basic travis.yml boilerplate for T2 Portal projects

language: python

python:
  - 2.7

services: 
  - mysql

env:
  - DJANGO=1.8.18 DB=mysql

before_install:
  - export DJANGO_SETTINGS_MODULE=pos_tools_portal.settings
  - export PYTHONPATH=$HOME/builds/lenchevsky/t2-portal
  - export PIP_USE_MIRRORS=true

install:
  - pip install -r ./tools/requirements.txt
  - pip install django==$DJANGO --quiet

before_script:
  - mysql -e 'create database travis_ci_db;'

script:
  - python pos_tools_portal/manage.py makemigrations --noinput    # Fetch DB changes
  - python pos_tools_portal/manage.py migrate                     # Apply database migrations
  - python pos_tools_portal/manage.py collectstatic --noinput     # Collect static files
  - python pos_tools_portal/manage.py check